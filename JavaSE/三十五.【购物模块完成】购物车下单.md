# 三十五.【购物模块完成】购物车下单

把addShoppingCartItem action复制粘题一下，

- 改个名字，叫做checkout。
- aciton的命名字符串，也改一下，叫“checkout”。
- 只需要一个jwt数据就足够了
- post请求，`http://123.56.149.216:8080/api/shoppingCart/checkout`
- post请求不需要body所以把第二个参数换成null
- return的数据将会使用data本身，不是shoppingcartitems

```javascript
export const checkout = createAsyncThunk(
	"shoppingCart/checkout",
	async (jwt: string) => {
		const { data } = await axios.post(
			`http://123.56.149.216:8080/api/shoppingCart/checkout`,
			null,
			{
				headers: {
					Authorization: `bearer ${jwt}`,
				},
			}
		);
		return data;
	}
);
```

处理reducer

items等于空数组，需要清空购物车

```引入useHistory hook，等会下单成功以后要做一个页面重定向，使用history.push导航到支付页面。javascript
[checkout.fulfilled.type]: (state, action) => {
	state.items = [];
	state.loading = false;
	state.error = null;
},
```

引入useHistory hook，使用navigate导航到支付页面。

```javascript
import { clearShoppingCart, checkout } from "../../redux/shoppingCart/slice";
import { useHistory } from "react-router-dom";

const history = useHistory();
```

处理下单支付按钮

```javascript
onCheckout={() => {
	if (shoppingCartItems.length <= 0) {
		return;
	}
	dispatch(checkout(jwt));
	history.push("/placeOrder"); // 进入订单页面
}}
```